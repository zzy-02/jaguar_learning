> 开始编写日期：2025年12月14日
作者：周梓芸
1. BIOS和UEFI启动的区别：
BIOS 通过读取磁盘扇区启动系统，功能有限；

UEFI 通过执行 EFI 文件启动系统，支持 GPT、大磁盘、网络和安全启动，是现代服务器和 Linux 的主流启动方式。
    - BIOS：
        Basic Input/Output System，老式启动，功能简单。
        > 启动流程：
        上电
        → BIOS 初始化硬件
        → 读磁盘第一个扇区（MBR）
        → 跳转执行 bootloader
        → 加载内核
    - UEFI：
        Unified Extensible Firmware Interface，现代固件接口标准，支持网络、文件系统、图形界面。
        > 启动流程：
        上电
        → UEFI 初始化硬件
        → 读取 EFI System Partition（ESP）
        → 执行 .efi 文件
        → 加载内核
    - 判断当前是UEFI还是BIOS
    `[ -d /sys/firmware/efi ] && echo UEFI || echo BIOS`
    `efibootmgr`
![BIOS和UEFI对比](图片\BIOS和UEFI对比.png)


2. 几种内核启动参数修改：
    主要分为GRUB修改和BLS修改，其他易混淆的概念下面还会补充：
    - **GRUB**：GRUB修改内核参数会有两种模式，第一种临时修改，第二种长期固定。这两种修改方式其实在之前ISCSI boot配置KOS510环境都使用过。
        - 长期固定GRUB：
        ```shell
        # 修改GRUB默认文件
        vim /etc/default/grub

        # 这里是拿kos510作为示例，找一个合适的位置插入，别的内容别动。...的位置是原本的内容别动！！！！
        GRUB_CMDLINE_LINUX="...keyarchos-swap  \
        rd.iscsi.initiator=iqn.2025-08.com.client:client01 \
        netroot=iscsi:@192.168.70.90::3260::iqn.2025-08.com.example:keyarchos-5.10 \
        rd.neednet=1 \
        ip=192.168.70.119:::255.255.255.0::p65p1:none \
        rd. lom. lv=keyarchos_ keyarchos...\
        rhgb quiet"

        # 固定命令，因系统而异，链接中的文档对应的命令可能稍有区别，该kos510最好用这个
        grub2-mkconfig -o /boot/efi/EFI/kos/grub.cfg # UEFI
        grub2-mkconfig -o /boot/grub2/grub.cfg  # BIOS

        ```
        - 临时修改GRUB：在系统启动时到GRUB菜单一直按`e`进入修改,重启失效

    - **BLS**：Rocky9 / RHEL8+ 推荐方式
        Boot Loader Specification，核心目录`/boot/loader/entries/`每一个`.config`文件都是一个启动项(内核)。参数修改需修改 `/boot/loader/entries/*.conf`，在 `options` 行里追加修改内容。

        这么设计的本意是避免每次新内核都要`mkconfig`导致`grub.cfg`巨大复杂容易冲突。

    - 以上内核参数修改都是作用在内核启动阶段，下面还有两个阶段会涉及到参数修改
        - 内核启动前：BIOS/UEFI Setup 固件菜单启动时按照提示进入BIOS setup界面，比如SNIC装备版本验证修改numa开关就是在这一步。
        - OS运行时参数：比较多，后面根据遇到的单独再写。OS 运行参数主要集中在网络配置、sysctl 内核运行参数、驱动模块参数以及 systemd 服务行为上，这些参数通常不需要重启即可生效，是服务器日常运维和测试中最频繁修改的内容。

        举例，这里贴一个同样在KOS510遇到的：业务网络ip配置：
        ```bash
        vim /etc/rc.local
        --------------------------------------------------
        #!/bin/bash
        # 配置业务网络IP和默认路由
        ip addr add 10.21.193.182/24 dev p65p1
        ip route del default
        # 10.21.193.254其实是PXE服务器，电口PXE
        ip route add default via 10.21.193.254 dev p65p1
        exit 0
        ---------------------------------------------------
        chmod +x /etc/rc.local
        -------------------------------------------------- 
        vim /etc/systemd/system/rc-local.service
        --------------------------------------------------
        [Unit]
        Description=/etc/rc.local Compatibility
        ConditionFileIsExecutable=/etc/rc.local
        After=network.target
        
        [Service]
        Type=forking
        ExecStart=/etc/rc.local start
        TimeoutSec=0
        RemainAfterExit=yes
        GuessMainPID=no
        
        [Install]
        WantedBy=multi-user.target
        -------------------------------------------------------
        # 使能服务，让上面文件生效的
        sudo systemctl enable rc-local
        sudo systemctl start rc-local
        ```
        此外，还有域名解析配置、yum环境配置等。

3. 内核：
    内核负责的事：管理CPU的调度、管理内存、管理设备驱动。是资源管理者
    内核可以比作发动机，操作系统比作整辆车
    一个内核可以对应多个os，一个os也可以有多个内核。
    常用的内核查看命令：
```bash
# 查看当前正在运行的内核
uname -r  # 5.14.0-427.el9.x86_64 数值说明参考下图

# 看系统里一共装了哪些内核 RPM 系（Rocky / RHEL / CentOS / Anolis 等
rpm -q kernel
ls /boot/loader/entries/

# Ubuntu,Ubuntu 不是 RPM，而是 DEB 包管理
dpkg -l | grep linux-image
ls /boot | grep vmlinuz

```
![5.14.0-427.el9.x86_64 数值说明参考下图](图片\内核字符串说明.png)
![常见后缀速查表](图片\os常见后缀名对应.png)

